{% extends "TGProdBundle::layout.html.twig" %}

{% block title %}
  Accueil - {{ parent() }}
{% endblock %}

{% block tgprod_body %}

<table>
<tr>
<td width="40%"><h2>Liste des projets en cours</h2></td>
<td width="40%"></td>
<td width="20%" class="text-right"><h4><a href="{{ path('tg_prod_archives') }}"><i class="glyphicon glyphicon-menu-right"></i> Projets archivés</a></h4></td>
</tr>
</table>
<br/>

{% if listProjets is not empty %}
<table class="table table-hover table-bordered">
  <thread>
    <tr>
      <th>#</th>
      <th>Nom du projet</th>
      <th>Type</th>
      <th>Publié par</th>
      <th>Pour le client</th>
      <th>Assigné à</th>
      <th>Concernant l'étape</th>
      <th>Dernière modification le</th>
      <th>Com</th>
    </tr>
  </thread>
  <tbody align="center">
    {% for projet in listProjets %}
    <tr bgcolor={{ projet.assign.couleur }}>
      <td>{{ projet.id }}</td>
      <td width="19%"><a href="{{ path('tg_prod_view', {'id': projet.id}) }}">
          {{ projet.titre }}</td>
      <td width="14%">{{ projet.type.name }}</td>
      <td width="14%">{{ projet.user }}</td>
      <td width="10%"><a href="{{ path('tg_client_view', {'id': projet.client.id}) }}">{{ projet.Client.name }}</td>
      <td width="14%">{{ projet.assign }}</td>
      <td width="14%">{{ projet.etape.name }}</td>
      <td width="20%">{{ projet.maj|date('d/m/Y') }}</td>
      <td>{{ projet.nbcommentaires }}</td>
    </tr>
    {% endfor %}

   {% else %}
      Pas de commande en cours pour le moment.<br/><br/>
      Vous pouvez utiliser la page dédiée pour <a href="{{ path('tg_prod_add') }}">créer un nouveau projet</a> ou choisir le client dans <a href="{{path("tg_client_home") }}">la liste</a>. 
  </tbody>
</table>
{% endif %}

    {% if nbPages > 1 %}
    <ul class="pagination">
      {% for p in range(1, nbPages) %}
        <li{% if p == page %} class="active"{% endif %}>
          <a href="{{ path('tg_prod_home', {'page': p}) }}">{{ p }}</a>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

{% endblock %}